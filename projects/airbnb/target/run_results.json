{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.16", "generated_at": "2025-12-17T11:26:23.659956Z", "invocation_id": "acf846c4-b625-4ea1-8e73-fb32a32facc2", "invocation_started_at": "2025-12-17T11:26:19.136937Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-17T11:26:21.263669Z", "completed_at": "2025-12-17T11:26:21.288213Z"}, {"name": "execute", "started_at": "2025-12-17T11:26:21.288571Z", "completed_at": "2025-12-17T11:26:21.288580Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0388798713684082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airbnb.l1_reviews", "compiled": true, "compiled_code": "select\n  'amsterdam' as city,\n  to_date('20250911', 'YYYYMMDD') as snapshot_date,\n  try_to_number(\"id\")           as review_id,\n  try_to_number(\"listing_id\")   as listing_id,\n  try_to_date(\"date\")           as review_date,\n  try_to_number(\"reviewer_id\")  as reviewer_id,\n  nullif(trim(\"reviewer_name\"), '') as reviewer_name,\n  \"comments\"                    as comments\nfrom AIRBNB.l0.raw__amsterdam__reviews__20250911\n\nunion all\nselect\n  'paris' as city,\n  to_date('20250912', 'YYYYMMDD') as snapshot_date,\n  try_to_number(\"id\")           as review_id,\n  try_to_number(\"listing_id\")   as listing_id,\n  try_to_date(\"date\")           as review_date,\n  try_to_number(\"reviewer_id\")  as reviewer_id,\n  nullif(trim(\"reviewer_name\"), '') as reviewer_name,\n  \"comments\"                    as comments\nfrom AIRBNB.l0.raw__paris__reviews__20250912\n\nunion all\nselect\n  'barcelona' as city,\n  to_date('20250914', 'YYYYMMDD') as snapshot_date,\n  try_to_number(\"id\")           as review_id,\n  try_to_number(\"listing_id\")   as listing_id,\n  try_to_date(\"date\")           as review_date,\n  try_to_number(\"reviewer_id\")  as reviewer_id,\n  nullif(trim(\"reviewer_name\"), '') as reviewer_name,\n  \"comments\"                    as comments\nfrom AIRBNB.l0.raw__barcelona__reviews__20250914\n\nunion all\nselect\n  'london' as city,\n  to_date('20250914', 'YYYYMMDD') as snapshot_date,\n  try_to_number(\"id\")           as review_id,\n  try_to_number(\"listing_id\")   as listing_id,\n  try_to_date(\"date\")           as review_date,\n  try_to_number(\"reviewer_id\")  as reviewer_id,\n  nullif(trim(\"reviewer_name\"), '') as reviewer_name,\n  \"comments\"                    as comments\nfrom AIRBNB.l0.raw__london__reviews__20250914\n\nunion all\nselect\n  'lisbon' as city,\n  to_date('20250921', 'YYYYMMDD') as snapshot_date,\n  try_to_number(\"id\")           as review_id,\n  try_to_number(\"listing_id\")   as listing_id,\n  try_to_date(\"date\")           as review_date,\n  try_to_number(\"reviewer_id\")  as reviewer_id,\n  nullif(trim(\"reviewer_name\"), '') as reviewer_name,\n  \"comments\"                    as comments\nfrom AIRBNB.l0.raw__lisbon__reviews__20250921", "relation_name": "AIRBNB.l0_l1.l1_reviews", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-17T11:26:21.290060Z", "completed_at": "2025-12-17T11:26:21.292629Z"}, {"name": "execute", "started_at": "2025-12-17T11:26:21.292773Z", "completed_at": "2025-12-17T11:26:21.292776Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.003451108932495117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airbnb.fct_reviews", "compiled": true, "compiled_code": "select *\nfrom AIRBNB.l0_l1.l1_reviews", "relation_name": "AIRBNB.l0_l2.fct_reviews", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-17T11:26:21.291618Z", "completed_at": "2025-12-17T11:26:21.293054Z"}, {"name": "execute", "started_at": "2025-12-17T11:26:21.293180Z", "completed_at": "2025-12-17T11:26:21.293182Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.001928091049194336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airbnb.dim_city", "compiled": true, "compiled_code": "SELECT\n  \"CITY\",\n  \"SNAPSHOT_DATE\",\n  MD5(CONCAT(TRIM(LOWER(\"CITY\")), '|', CAST(\"SNAPSHOT_DATE\" AS VARCHAR))) AS city_snapshot_key\nFROM AIRBNB.l0_l1.l1_reviews\nGROUP BY \"CITY\", \"SNAPSHOT_DATE\"\nORDER BY \"CITY\", \"SNAPSHOT_DATE\"", "relation_name": "AIRBNB.l0_l2.dim_city", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-17T11:26:21.281496Z", "completed_at": "2025-12-17T11:26:22.688582Z"}, {"name": "execute", "started_at": "2025-12-17T11:26:22.689046Z", "completed_at": "2025-12-17T11:26:22.689063Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4391248226165771, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airbnb.l1_calendar", "compiled": true, "compiled_code": "select\n  'amsterdam' as city,\n  to_date('20250911', 'YYYYMMDD') as snapshot_date,\n  \"listing_id\" as listing_id,\n  to_date(\"date\") as date,\n  \"available\" as available,\n  try_to_decimal(regexp_replace(\"price\", '[^0-9\\.\\-]', ''), 10, 2) as price,\n  try_to_decimal(regexp_replace(\"adjusted_price\", '[^0-9\\.\\-]', ''), 10, 2) as adjusted_price,\n  try_to_number(\"minimum_nights\") as minimum_nights,\n  try_to_number(\"maximum_nights\") as maximum_nights\nfrom AIRBNB.l0.raw__amsterdam__calendar__20250911\n\nUNION ALL\nselect\n  'barcelona' as city,\n  to_date('20250914', 'YYYYMMDD') as snapshot_date,\n  \"listing_id\" as listing_id,\n  to_date(\"date\") as date,\n  \"available\" as available,\n  try_to_decimal(regexp_replace(\"price\", '[^0-9\\.\\-]', ''), 10, 2) as price,\n  try_to_decimal(regexp_replace(\"adjusted_price\", '[^0-9\\.\\-]', ''), 10, 2) as adjusted_price,\n  try_to_number(\"minimum_nights\") as minimum_nights,\n  try_to_number(\"maximum_nights\") as maximum_nights\nfrom AIRBNB.l0.raw__barcelona__calendar__20250914\nUNION ALL\nselect\n  'paris' as city,\n  to_date('20250912', 'YYYYMMDD') as snapshot_date,\n  \"listing_id\" as listing_id,\n  to_date(\"date\") as date,\n  \"available\" as available,\n  try_to_decimal(regexp_replace(\"price\", '[^0-9\\.\\-]', ''), 10, 2) as price,\n  try_to_decimal(regexp_replace(\"adjusted_price\", '[^0-9\\.\\-]', ''), 10, 2) as adjusted_price,\n  try_to_number(\"minimum_nights\") as minimum_nights,\n  try_to_number(\"maximum_nights\") as maximum_nights\nfrom AIRBNB.l0.raw__paris__calendar__20250912\nUNION ALL\nselect\n  'lisbon' as city,\n  to_date('20250921', 'YYYYMMDD') as snapshot_date,\n  \"listing_id\" as listing_id,\n  to_date(\"date\") as date,\n  \"available\" as available,\n  try_to_decimal(regexp_replace(\"price\", '[^0-9\\.\\-]', ''), 10, 2) as price,\n  try_to_decimal(regexp_replace(\"adjusted_price\", '[^0-9\\.\\-]', ''), 10, 2) as adjusted_price,\n  try_to_number(\"minimum_nights\") as minimum_nights,\n  try_to_number(\"maximum_nights\") as maximum_nights\nfrom AIRBNB.l0.raw__lisbon__calendar__20250921\nUNION ALL\nselect\n  'london' as city,\n  to_date('20250914', 'YYYYMMDD') as snapshot_date,\n  \"listing_id\" as listing_id,\n  to_date(\"date\") as date,\n  \"available\" as available,\n  try_to_decimal(regexp_replace(\"price\", '[^0-9\\.\\-]', ''), 10, 2) as price,\n  try_to_decimal(regexp_replace(\"adjusted_price\", '[^0-9\\.\\-]', ''), 10, 2) as adjusted_price,\n  try_to_number(\"minimum_nights\") as minimum_nights,\n  try_to_number(\"maximum_nights\") as maximum_nights\nfrom AIRBNB.l0.raw__london__calendar__20250914", "relation_name": "AIRBNB.l0_l1.l1_calendar", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-17T11:26:22.692467Z", "completed_at": "2025-12-17T11:26:22.700157Z"}, {"name": "execute", "started_at": "2025-12-17T11:26:22.700587Z", "completed_at": "2025-12-17T11:26:22.700596Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.009825944900512695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airbnb.dim_calendar", "compiled": true, "compiled_code": "with bounds as (\n    select\n        min(\"DATE\") as min_date,\n        max(\"DATE\") as max_date\n    from AIRBNB.l0_l1.l1_calendar\n),\n\ndates as (\n    select\n        dateadd(day, seq4(), b.min_date) as \"DATE\"\n    from bounds b,\n         table(generator(rowcount => 10000))  -- big enough\n    where dateadd(day, seq4(), b.min_date) <= b.max_date\n)\n\nselect\n    \"DATE\"                                       as \"DATE\",\n    year(\"DATE\")                                 as \"YEAR\",\n    month(\"DATE\")                                as \"MONTH\",\n    monthname(\"DATE\")                            as \"MONTH_NAME\",\n    day(\"DATE\")                                  as \"DAY\",\n    dayofweekiso(\"DATE\")                         as \"DAY_OF_WEEK\",\n    weekofyear(\"DATE\")                           as \"WEEK_OF_YEAR\",\n    quarter(\"DATE\")                              as \"QUARTER\",\n    iff(dayofweekiso(\"DATE\") in (6,7), true, false) as \"IS_WEEKEND\"\nfrom dates\norder by \"DATE\"", "relation_name": "AIRBNB.l0_l2.dim_calendar", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-17T11:26:22.696375Z", "completed_at": "2025-12-17T11:26:22.701263Z"}, {"name": "execute", "started_at": "2025-12-17T11:26:22.701618Z", "completed_at": "2025-12-17T11:26:22.701624Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.010290861129760742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airbnb.fct_calendar", "compiled": true, "compiled_code": "select *\nfrom AIRBNB.l0_l1.l1_calendar", "relation_name": "AIRBNB.l0_l2.fct_calendar", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-17T11:26:21.251121Z", "completed_at": "2025-12-17T11:26:22.758061Z"}, {"name": "execute", "started_at": "2025-12-17T11:26:22.758517Z", "completed_at": "2025-12-17T11:26:22.758527Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.5092658996582031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airbnb.l1_listings", "compiled": true, "compiled_code": "select\n  'amsterdam' as city,\n  to_date('20250911', 'YYYYMMDD') as snapshot_date,\n  \"id\" as listing_id,\n  \"listing_url\" as listing_url,\n  nullif(trim(\"name\"), '') as name,\n  \"source\" as source,\n  try_to_date(\"last_scraped\") as last_scraped,\n  try_to_date(\"last_review\") as last_review,\n\n  try_to_double(\"latitude\") as latitude,\n  try_to_double(\"longitude\") as longitude,\n  nullif(trim(\"license\"), '') as license,\n\n  nullif(trim(\"property_type\"), '') as property_type,\n  nullif(trim(\"room_type\"), '') as room_type,\n\n  nullif(trim(\"neighbourhood\"), '') as neighbourhood,\n  nullif(trim(\"neighbourhood_cleansed\"), '') as neighbourhood_cleansed,\n  nullif(trim(\"neighbourhood_group_cleansed\"), '') as neighbourhood_group_cleansed,\n  nullif(trim(\"neighborhood_overview\"), '') as neighborhood_overview,coalesce(\n      try_to_decimal(regexp_replace(\"price\", '[^0-9\\.\\-]', ''), 10, 2),\n      try_to_decimal(\n        regexp_replace(to_varchar(\"price\"), '[^0-9\\.\\-]', ''),\n        10, 2\n      )\n    ) as price,\n\n  case when lower(\"instant_bookable\") in ('t','true','1','yes','y') then true when lower(\"instant_bookable\") in ('f','false','0','no','n') then false else null end as instant_bookable,\n\n  \"host_url\" as host_url,\n  try_to_date(\"host_since\") as host_since,\n  try_to_double(\"host_total_listings_count\") as host_total_listings_count,\n  nullif(trim(\"host_response_time\"), '') as host_response_time,\n  -- \"98%\" -> 0.98 ; \"98\" -> 0.98 ; null stays null\n  case\n    when \"host_response_rate\" is null then null\n    else try_to_decimal(regexp_replace(\"host_response_rate\", '[^0-9\\.\\-]', ''), 10, 2) / 100\n  end as host_response_rate,\n  \"host_verifications\" as host_verifications,\n  \"host_thumbnail_url\" as host_thumbnail_url,\n  \"host_picture_url\" as host_picture_url,\n\n  \"picture_url\" as picture_url,\n\n  try_to_number(\"minimum_nights\") as minimum_nights,\n  try_to_number(\"maximum_nights\") as maximum_nights,\n  try_to_double(\"minimum_minimum_nights\") as minimum_minimum_nights,\n  try_to_double(\"maximum_minimum_nights\") as maximum_minimum_nights,\n  try_to_double(\"minimum_maximum_nights\") as minimum_maximum_nights,\n  try_to_double(\"maximum_maximum_nights\") as maximum_maximum_nights,\n  try_to_double(\"minimum_nights_avg_ntm\") as minimum_nights_avg_ntm,\n  try_to_double(\"maximum_nights_avg_ntm\") as maximum_nights_avg_ntm,\n\n  try_to_number(\"number_of_reviews\") as number_of_reviews,\n  try_to_number(\"number_of_reviews_ltm\") as number_of_reviews_ltm,\n  try_to_number(\"number_of_reviews_l30d\") as number_of_reviews_l30d,\n  try_to_number(\"number_of_reviews_ly\") as number_of_reviews_ly,\n  try_to_double(\"reviews_per_month\") as reviews_per_month,\n\n  try_to_double(\"review_scores_rating\") as review_scores_rating,\n  try_to_double(\"review_scores_accuracy\") as review_scores_accuracy,\n  try_to_double(\"review_scores_cleanliness\") as review_scores_cleanliness,\n  try_to_double(\"review_scores_checkin\") as review_scores_checkin,\n  try_to_double(\"review_scores_communication\") as review_scores_communication,\n  try_to_double(\"review_scores_location\") as review_scores_location,\n  try_to_double(\"review_scores_value\") as review_scores_value\nfrom AIRBNB.l0.raw__amsterdam__listings__20250911\n\nunion all\nselect\n  'paris' as city,\n  to_date('20250912', 'YYYYMMDD') as snapshot_date,\n  \"id\" as listing_id,\n  \"listing_url\" as listing_url,\n  nullif(trim(\"name\"), '') as name,\n  \"source\" as source,\n  try_to_date(\"last_scraped\") as last_scraped,\n  try_to_date(\"last_review\") as last_review,\n\n  try_to_double(\"latitude\") as latitude,\n  try_to_double(\"longitude\") as longitude,\n  nullif(trim(\"license\"), '') as license,\n\n  nullif(trim(\"property_type\"), '') as property_type,\n  nullif(trim(\"room_type\"), '') as room_type,\n\n  nullif(trim(\"neighbourhood\"), '') as neighbourhood,\n  nullif(trim(\"neighbourhood_cleansed\"), '') as neighbourhood_cleansed,\n  nullif(trim(\"neighbourhood_group_cleansed\"), '') as neighbourhood_group_cleansed,\n  nullif(trim(\"neighborhood_overview\"), '') as neighborhood_overview,coalesce(\n      try_to_decimal(regexp_replace(\"price\", '[^0-9\\.\\-]', ''), 10, 2),\n      try_to_decimal(\n        regexp_replace(to_varchar(\"price\"), '[^0-9\\.\\-]', ''),\n        10, 2\n      )\n    ) as price,\n\n  case when lower(\"instant_bookable\") in ('t','true','1','yes','y') then true when lower(\"instant_bookable\") in ('f','false','0','no','n') then false else null end as instant_bookable,\n\n  \"host_url\" as host_url,\n  try_to_date(\"host_since\") as host_since,\n  try_to_double(\"host_total_listings_count\") as host_total_listings_count,\n  nullif(trim(\"host_response_time\"), '') as host_response_time,\n  -- \"98%\" -> 0.98 ; \"98\" -> 0.98 ; null stays null\n  case\n    when \"host_response_rate\" is null then null\n    else try_to_decimal(regexp_replace(\"host_response_rate\", '[^0-9\\.\\-]', ''), 10, 2) / 100\n  end as host_response_rate,\n  \"host_verifications\" as host_verifications,\n  \"host_thumbnail_url\" as host_thumbnail_url,\n  \"host_picture_url\" as host_picture_url,\n\n  \"picture_url\" as picture_url,\n\n  try_to_number(\"minimum_nights\") as minimum_nights,\n  try_to_number(\"maximum_nights\") as maximum_nights,\n  try_to_double(\"minimum_minimum_nights\") as minimum_minimum_nights,\n  try_to_double(\"maximum_minimum_nights\") as maximum_minimum_nights,\n  try_to_double(\"minimum_maximum_nights\") as minimum_maximum_nights,\n  try_to_double(\"maximum_maximum_nights\") as maximum_maximum_nights,\n  try_to_double(\"minimum_nights_avg_ntm\") as minimum_nights_avg_ntm,\n  try_to_double(\"maximum_nights_avg_ntm\") as maximum_nights_avg_ntm,\n\n  try_to_number(\"number_of_reviews\") as number_of_reviews,\n  try_to_number(\"number_of_reviews_ltm\") as number_of_reviews_ltm,\n  try_to_number(\"number_of_reviews_l30d\") as number_of_reviews_l30d,\n  try_to_number(\"number_of_reviews_ly\") as number_of_reviews_ly,\n  try_to_double(\"reviews_per_month\") as reviews_per_month,\n\n  try_to_double(\"review_scores_rating\") as review_scores_rating,\n  try_to_double(\"review_scores_accuracy\") as review_scores_accuracy,\n  try_to_double(\"review_scores_cleanliness\") as review_scores_cleanliness,\n  try_to_double(\"review_scores_checkin\") as review_scores_checkin,\n  try_to_double(\"review_scores_communication\") as review_scores_communication,\n  try_to_double(\"review_scores_location\") as review_scores_location,\n  try_to_double(\"review_scores_value\") as review_scores_value\nfrom AIRBNB.l0.raw__paris__listings__20250912\n\nunion all\nselect\n  'barcelona' as city,\n  to_date('20250914', 'YYYYMMDD') as snapshot_date,\n  \"id\" as listing_id,\n  \"listing_url\" as listing_url,\n  nullif(trim(\"name\"), '') as name,\n  \"source\" as source,\n  try_to_date(\"last_scraped\") as last_scraped,\n  try_to_date(\"last_review\") as last_review,\n\n  try_to_double(\"latitude\") as latitude,\n  try_to_double(\"longitude\") as longitude,\n  nullif(trim(\"license\"), '') as license,\n\n  nullif(trim(\"property_type\"), '') as property_type,\n  nullif(trim(\"room_type\"), '') as room_type,\n\n  nullif(trim(\"neighbourhood\"), '') as neighbourhood,\n  nullif(trim(\"neighbourhood_cleansed\"), '') as neighbourhood_cleansed,\n  nullif(trim(\"neighbourhood_group_cleansed\"), '') as neighbourhood_group_cleansed,\n  nullif(trim(\"neighborhood_overview\"), '') as neighborhood_overview,coalesce(\n      try_to_decimal(regexp_replace(\"price\", '[^0-9\\.\\-]', ''), 10, 2),\n      try_to_decimal(\n        regexp_replace(to_varchar(\"price\"), '[^0-9\\.\\-]', ''),\n        10, 2\n      )\n    ) as price,\n\n  case when lower(\"instant_bookable\") in ('t','true','1','yes','y') then true when lower(\"instant_bookable\") in ('f','false','0','no','n') then false else null end as instant_bookable,\n\n  \"host_url\" as host_url,\n  try_to_date(\"host_since\") as host_since,\n  try_to_double(\"host_total_listings_count\") as host_total_listings_count,\n  nullif(trim(\"host_response_time\"), '') as host_response_time,\n  -- \"98%\" -> 0.98 ; \"98\" -> 0.98 ; null stays null\n  case\n    when \"host_response_rate\" is null then null\n    else try_to_decimal(regexp_replace(\"host_response_rate\", '[^0-9\\.\\-]', ''), 10, 2) / 100\n  end as host_response_rate,\n  \"host_verifications\" as host_verifications,\n  \"host_thumbnail_url\" as host_thumbnail_url,\n  \"host_picture_url\" as host_picture_url,\n\n  \"picture_url\" as picture_url,\n\n  try_to_number(\"minimum_nights\") as minimum_nights,\n  try_to_number(\"maximum_nights\") as maximum_nights,\n  try_to_double(\"minimum_minimum_nights\") as minimum_minimum_nights,\n  try_to_double(\"maximum_minimum_nights\") as maximum_minimum_nights,\n  try_to_double(\"minimum_maximum_nights\") as minimum_maximum_nights,\n  try_to_double(\"maximum_maximum_nights\") as maximum_maximum_nights,\n  try_to_double(\"minimum_nights_avg_ntm\") as minimum_nights_avg_ntm,\n  try_to_double(\"maximum_nights_avg_ntm\") as maximum_nights_avg_ntm,\n\n  try_to_number(\"number_of_reviews\") as number_of_reviews,\n  try_to_number(\"number_of_reviews_ltm\") as number_of_reviews_ltm,\n  try_to_number(\"number_of_reviews_l30d\") as number_of_reviews_l30d,\n  try_to_number(\"number_of_reviews_ly\") as number_of_reviews_ly,\n  try_to_double(\"reviews_per_month\") as reviews_per_month,\n\n  try_to_double(\"review_scores_rating\") as review_scores_rating,\n  try_to_double(\"review_scores_accuracy\") as review_scores_accuracy,\n  try_to_double(\"review_scores_cleanliness\") as review_scores_cleanliness,\n  try_to_double(\"review_scores_checkin\") as review_scores_checkin,\n  try_to_double(\"review_scores_communication\") as review_scores_communication,\n  try_to_double(\"review_scores_location\") as review_scores_location,\n  try_to_double(\"review_scores_value\") as review_scores_value\nfrom AIRBNB.l0.raw__barcelona__listings__20250914\n\nunion all\nselect\n  'london' as city,\n  to_date('20250914', 'YYYYMMDD') as snapshot_date,\n  \"id\" as listing_id,\n  \"listing_url\" as listing_url,\n  nullif(trim(\"name\"), '') as name,\n  \"source\" as source,\n  try_to_date(\"last_scraped\") as last_scraped,\n  try_to_date(\"last_review\") as last_review,\n\n  try_to_double(\"latitude\") as latitude,\n  try_to_double(\"longitude\") as longitude,\n  nullif(trim(\"license\"), '') as license,\n\n  nullif(trim(\"property_type\"), '') as property_type,\n  nullif(trim(\"room_type\"), '') as room_type,\n\n  nullif(trim(\"neighbourhood\"), '') as neighbourhood,\n  nullif(trim(\"neighbourhood_cleansed\"), '') as neighbourhood_cleansed,\n  nullif(trim(\"neighbourhood_group_cleansed\"), '') as neighbourhood_group_cleansed,\n  nullif(trim(\"neighborhood_overview\"), '') as neighborhood_overview,coalesce(\n      try_to_decimal(regexp_replace(\"price\", '[^0-9\\.\\-]', ''), 10, 2),\n      try_to_decimal(\n        regexp_replace(to_varchar(\"price\"), '[^0-9\\.\\-]', ''),\n        10, 2\n      )\n    ) as price,\n\n  case when lower(\"instant_bookable\") in ('t','true','1','yes','y') then true when lower(\"instant_bookable\") in ('f','false','0','no','n') then false else null end as instant_bookable,\n\n  \"host_url\" as host_url,\n  try_to_date(\"host_since\") as host_since,\n  try_to_double(\"host_total_listings_count\") as host_total_listings_count,\n  nullif(trim(\"host_response_time\"), '') as host_response_time,\n  -- \"98%\" -> 0.98 ; \"98\" -> 0.98 ; null stays null\n  case\n    when \"host_response_rate\" is null then null\n    else try_to_decimal(regexp_replace(\"host_response_rate\", '[^0-9\\.\\-]', ''), 10, 2) / 100\n  end as host_response_rate,\n  \"host_verifications\" as host_verifications,\n  \"host_thumbnail_url\" as host_thumbnail_url,\n  \"host_picture_url\" as host_picture_url,\n\n  \"picture_url\" as picture_url,\n\n  try_to_number(\"minimum_nights\") as minimum_nights,\n  try_to_number(\"maximum_nights\") as maximum_nights,\n  try_to_double(\"minimum_minimum_nights\") as minimum_minimum_nights,\n  try_to_double(\"maximum_minimum_nights\") as maximum_minimum_nights,\n  try_to_double(\"minimum_maximum_nights\") as minimum_maximum_nights,\n  try_to_double(\"maximum_maximum_nights\") as maximum_maximum_nights,\n  try_to_double(\"minimum_nights_avg_ntm\") as minimum_nights_avg_ntm,\n  try_to_double(\"maximum_nights_avg_ntm\") as maximum_nights_avg_ntm,\n\n  try_to_number(\"number_of_reviews\") as number_of_reviews,\n  try_to_number(\"number_of_reviews_ltm\") as number_of_reviews_ltm,\n  try_to_number(\"number_of_reviews_l30d\") as number_of_reviews_l30d,\n  try_to_number(\"number_of_reviews_ly\") as number_of_reviews_ly,\n  try_to_double(\"reviews_per_month\") as reviews_per_month,\n\n  try_to_double(\"review_scores_rating\") as review_scores_rating,\n  try_to_double(\"review_scores_accuracy\") as review_scores_accuracy,\n  try_to_double(\"review_scores_cleanliness\") as review_scores_cleanliness,\n  try_to_double(\"review_scores_checkin\") as review_scores_checkin,\n  try_to_double(\"review_scores_communication\") as review_scores_communication,\n  try_to_double(\"review_scores_location\") as review_scores_location,\n  try_to_double(\"review_scores_value\") as review_scores_value\nfrom AIRBNB.l0.raw__london__listings__20250914\n\nunion all\nselect\n  'lisbon' as city,\n  to_date('20250921', 'YYYYMMDD') as snapshot_date,\n  \"id\" as listing_id,\n  \"listing_url\" as listing_url,\n  nullif(trim(\"name\"), '') as name,\n  \"source\" as source,\n  try_to_date(\"last_scraped\") as last_scraped,\n  try_to_date(\"last_review\") as last_review,\n\n  try_to_double(\"latitude\") as latitude,\n  try_to_double(\"longitude\") as longitude,\n  nullif(trim(\"license\"), '') as license,\n\n  nullif(trim(\"property_type\"), '') as property_type,\n  nullif(trim(\"room_type\"), '') as room_type,\n\n  nullif(trim(\"neighbourhood\"), '') as neighbourhood,\n  nullif(trim(\"neighbourhood_cleansed\"), '') as neighbourhood_cleansed,\n  nullif(trim(\"neighbourhood_group_cleansed\"), '') as neighbourhood_group_cleansed,\n  nullif(trim(\"neighborhood_overview\"), '') as neighborhood_overview,coalesce(\n      try_to_decimal(regexp_replace(\"price\", '[^0-9\\.\\-]', ''), 10, 2),\n      try_to_decimal(\n        regexp_replace(to_varchar(\"price\"), '[^0-9\\.\\-]', ''),\n        10, 2\n      )\n    ) as price,\n\n  case when lower(\"instant_bookable\") in ('t','true','1','yes','y') then true when lower(\"instant_bookable\") in ('f','false','0','no','n') then false else null end as instant_bookable,\n\n  \"host_url\" as host_url,\n  try_to_date(\"host_since\") as host_since,\n  try_to_double(\"host_total_listings_count\") as host_total_listings_count,\n  nullif(trim(\"host_response_time\"), '') as host_response_time,\n  -- \"98%\" -> 0.98 ; \"98\" -> 0.98 ; null stays null\n  case\n    when \"host_response_rate\" is null then null\n    else try_to_decimal(regexp_replace(\"host_response_rate\", '[^0-9\\.\\-]', ''), 10, 2) / 100\n  end as host_response_rate,\n  \"host_verifications\" as host_verifications,\n  \"host_thumbnail_url\" as host_thumbnail_url,\n  \"host_picture_url\" as host_picture_url,\n\n  \"picture_url\" as picture_url,\n\n  try_to_number(\"minimum_nights\") as minimum_nights,\n  try_to_number(\"maximum_nights\") as maximum_nights,\n  try_to_double(\"minimum_minimum_nights\") as minimum_minimum_nights,\n  try_to_double(\"maximum_minimum_nights\") as maximum_minimum_nights,\n  try_to_double(\"minimum_maximum_nights\") as minimum_maximum_nights,\n  try_to_double(\"maximum_maximum_nights\") as maximum_maximum_nights,\n  try_to_double(\"minimum_nights_avg_ntm\") as minimum_nights_avg_ntm,\n  try_to_double(\"maximum_nights_avg_ntm\") as maximum_nights_avg_ntm,\n\n  try_to_number(\"number_of_reviews\") as number_of_reviews,\n  try_to_number(\"number_of_reviews_ltm\") as number_of_reviews_ltm,\n  try_to_number(\"number_of_reviews_l30d\") as number_of_reviews_l30d,\n  try_to_number(\"number_of_reviews_ly\") as number_of_reviews_ly,\n  try_to_double(\"reviews_per_month\") as reviews_per_month,\n\n  try_to_double(\"review_scores_rating\") as review_scores_rating,\n  try_to_double(\"review_scores_accuracy\") as review_scores_accuracy,\n  try_to_double(\"review_scores_cleanliness\") as review_scores_cleanliness,\n  try_to_double(\"review_scores_checkin\") as review_scores_checkin,\n  try_to_double(\"review_scores_communication\") as review_scores_communication,\n  try_to_double(\"review_scores_location\") as review_scores_location,\n  try_to_double(\"review_scores_value\") as review_scores_value\nfrom AIRBNB.l0.raw__lisbon__listings__20250921", "relation_name": "AIRBNB.l0_l1.l1_listings", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-17T11:26:22.765273Z", "completed_at": "2025-12-17T11:26:22.773170Z"}, {"name": "execute", "started_at": "2025-12-17T11:26:22.773438Z", "completed_at": "2025-12-17T11:26:22.773442Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.012618064880371094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airbnb.dim_neighbourhoods", "compiled": true, "compiled_code": "SELECT\n    \"CITY\",\n  \"NEIGHBOURHOOD_CLEANSED\",\n  MD5(CONCAT(TRIM(LOWER(\"NEIGHBOURHOOD_CLEANSED\")), '|', TRIM(LOWER(\"CITY\")))) AS neighbourhood_key\nFROM AIRBNB.l0_l1.l1_listings\nGROUP BY \"CITY\", \"NEIGHBOURHOOD_CLEANSED\"\nORDER BY \"CITY\", \"NEIGHBOURHOOD_CLEANSED\"", "relation_name": "AIRBNB.l0_l2.dim_neighbourhoods", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-17T11:26:22.761805Z", "completed_at": "2025-12-17T11:26:22.773873Z"}, {"name": "execute", "started_at": "2025-12-17T11:26:22.774131Z", "completed_at": "2025-12-17T11:26:22.774135Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.013855934143066406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airbnb.dim_listings", "compiled": true, "compiled_code": "select *\nfrom AIRBNB.l0_l1.l1_listings", "relation_name": "AIRBNB.l0_l2.dim_listings", "batch_results": null}], "elapsed_time": 3.9500889778137207, "args": {"indirect_selection": "eager", "project_dir": "/Users/jonnygreenwood/Documents/airbnb-snowflake-dbt/airbnb", "require_generic_test_arguments_property": true, "skip_nodes_if_on_run_start_fails": false, "write_json": true, "require_explicit_package_overrides_for_builtin_materializations": true, "require_yaml_configuration_for_mf_time_spines": false, "require_resource_names_without_spaces": true, "source_freshness_run_project_hooks": true, "log_format": "default", "defer": false, "empty_catalog": false, "show_all_deprecations": false, "which": "generate", "quiet": false, "compile": true, "send_anonymous_usage_stats": true, "invocation_command": "dbt docs generate", "use_fast_test_edges": false, "exclude": [], "strict_mode": false, "populate_cache": true, "static": false, "require_all_warnings_handled_by_warn_error": false, "macro_debugging": false, "log_format_file": "debug", "warn_error_options": {"error": [], "warn": [], "silence": []}, "introspect": true, "partial_parse": true, "cache_selected_only": false, "select": [], "log_path": "/Users/jonnygreenwood/Documents/airbnb-snowflake-dbt/airbnb/logs", "state_modified_compare_more_unrendered_values": false, "partial_parse_file_diff": true, "require_batched_execution_for_custom_microbatch_strategy": false, "require_nested_cumulative_type_params": false, "use_colors": true, "version_check": true, "log_level_file": "debug", "log_level": "info", "profiles_dir": "/Users/jonnygreenwood/.dbt", "use_colors_file": true, "static_parser": true, "log_file_max_bytes": 10485760, "upload_to_artifacts_ingest_api": false, "validate_macro_args": false, "show_resource_report": false, "vars": {}, "state_modified_compare_vars": false, "print": true, "favor_state": false, "printer_width": 80}}